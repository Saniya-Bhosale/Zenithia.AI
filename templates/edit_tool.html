{% extends "base.html" %}

{% block title %}Edit Tool - Admin Panel{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-md-10 offset-md-1">
            <div class="card shadow">
                <div class="card-header bg-warning text-dark">
                    <h3><i class="fas fa-edit"></i> Edit Tool: {{ tool.name }}</h3>
                </div>
                <div class="card-body p-4">
                    <form method="POST" action="{{ url_for('edit_tool', id=tool.id) }}">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="name" class="form-label">Tool Name *</label>
                                <input type="text" class="form-control" id="name" name="name" 
                                       value="{{ tool.name }}" required>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="category" class="form-label">Category *</label>
                                <select class="form-control" id="category" name="category" required>
                                    <option value="Writing" {% if tool.category == 'Writing' %}selected{% endif %}>Writing</option>
                                    <option value="Coding" {% if tool.category == 'Coding' %}selected{% endif %}>Coding</option>
                                    <option value="Image" {% if tool.category == 'Image' %}selected{% endif %}>Image</option>
                                    <option value="Video" {% if tool.category == 'Video' %}selected{% endif %}>Video</option>
                                    <option value="Voice" {% if tool.category == 'Voice' %}selected{% endif %}>Voice</option>
                                    <option value="Productivity" {% if tool.category == 'Productivity' %}selected{% endif %}>Productivity</option>
                                </select>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="description" class="form-label">Description *</label>
                            <textarea class="form-control" id="description" name="description" 
                                      rows="4" required>{{ tool.description }}</textarea>
                        </div>

                        <div class="mb-3">
                            <label for="tool_link" class="form-label">Tool Link (URL) *</label>
                            <input type="url" class="form-control" id="tool_link" name="tool_link" 
                                   value="{{ tool.tool_link }}" 
                                   placeholder="https://example.com" required>
                            <small class="text-muted">Enter the full URL including https://</small>
                        </div>

                        <div class="mb-3">
                            <label for="image_url" class="form-label">Image URL</label>
                            <input type="url" class="form-control" id="image_url" name="image_url" 
                                   value="{{ tool.image_url if tool.image_url else '' }}" 
                                   placeholder="https://example.com/image.png">
                            <small class="text-muted">Enter the image URL (optional). Leave blank for default.</small>
                        </div>

                        <!-- Image Preview -->
                        <div class="mb-4">
                            <label class="form-label">Current Image Preview:</label>
                            <div class="border rounded p-3 bg-light text-center">
                                {% if tool.image_url %}
                                    <img id="imagePreview" src="{{ tool.image_url }}" 
                                         alt="{{ tool.name }}" 
                                         class="img-thumbnail" 
                                         style="max-width: 200px; max-height: 200px;"
                                         onerror="this.src='https://via.placeholder.com/200?text=No+Image+Available'">
                                {% else %}
                                    <img id="imagePreview" src="https://via.placeholder.com/200?text=No+Image+Available" 
                                         alt="No image" 
                                         class="img-thumbnail" 
                                         style="max-width: 200px; max-height: 200px;">
                                {% endif %}
                            </div>
                        </div>

                        <div class="d-flex gap-2">
                            <button type="submit" class="btn btn-warning">
                                <i class="fas fa-save"></i> Update Tool
                            </button>
                            <a href="{{ url_for('manage_tools') }}" class="btn btn-secondary">
                                <i class="fas fa-times"></i> Cancel
                            </a>
                            <a href="{{ url_for('tool_detail', id=tool.id) }}" class="btn btn-info">
                                <i class="fas fa-eye"></i> View Tool
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Live image preview
document.getElementById('image_url').addEventListener('input', function() {
    const imageUrl = this.value;
    const preview = document.getElementById('imagePreview');
    if (imageUrl) {
        preview.src = imageUrl;
    } else {
        preview.src = 'https://via.placeholder.com/200?text=No+Image+Available';
    }
});
</script>
{% endblock %}
